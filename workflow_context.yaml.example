---
# SDLC Workflow Context Configuration
# 工作流程執行上下文配置範本
#
# 此文件定義 SDLC State Machine 工作流程的關鍵字注入配置。
# 所有 ${VARIABLE} 格式的變數會在運行時被解析。
#
# 使用方式：
# 1. 設定環境變數後執行: arkhon-rheo workflow run --config .agent/workflow-context.yaml
# 2. CLI 覆蓋: arkhon-rheo workflow run --var PROJECT_NAME="my-app" --var LANGUAGE="python"
# 3. Python API: engine = WorkflowEngine.from_markdown(..., context_vars={...})
---
workflow_config:
  # ========================================
  # 專案基本資訊
  # ========================================
  project:
    # 專案名稱 (建議使用 kebab-case)
    name: "${PROJECT_NAME}"
    # 範例: "user-authentication-system", "payment-gateway", "api-dashboard"

    # 專案類型
    type: "${PROJECT_TYPE}"
    # 選項: "backend" | "frontend" | "fullstack" | "mobile" | "data-pipeline"

    # 優先級
    priority: "${PRIORITY}"
    # 選項: "High" | "Medium" | "Low"

    # 專案描述 (可選)
    description: "${PROJECT_DESCRIPTION:-未設定}"

  # ========================================
  # 技術堆疊配置
  # ========================================
  tech_stack:
    # 主要程式語言
    primary_language: "${LANGUAGE}"
    # 支援: "python" | "typescript" | "javascript" | "go" | "rust" | "java" | "csharp"

    # 框架/函式庫
    framework: "${FRAMEWORK}"
    # Python: "django" | "fastapi" | "flask"
    # TypeScript/JS: "nextjs" | "react" | "vue" | "angular" | "express"
    # Go: "gin" | "echo" | "fiber"
    # Rust: "actix" | "rocket" | "axum"

    # 資料庫系統
    database: "${DATABASE}"
    # SQL: "postgresql" | "mysql" | "sqlite"
    # NoSQL: "mongodb" | "redis" | "dynamodb" | "cassandra"
    # 向量: "pinecone" | "weaviate" | "qdrant"

    # 部署平台
    deployment: "${DEPLOYMENT}"
    # 選項: "kubernetes" | "docker" | "serverless" | "heroku" | "vercel" | "aws" | "gcp"

    # 其他技術 (可選)
    orm: "${ORM:-未設定}"
    # 範例: "sqlalchemy", "prisma", "typeorm", "gorm"

    testing_framework: "${TEST_FRAMEWORK:-pytest}"
    # Python: "pytest", "unittest"
    # TypeScript: "jest", "vitest", "playwright"

  # ========================================
  # Skills 過濾與推薦
  # ========================================
  skill_preferences:
    # 語言專家 Skill (自動解析)
    language_expert: "${LANGUAGE}-pro"
    # 解析範例: "python" → "python-pro", "typescript" → "typescript-pro"

    # 框架專家 Skill (自動解析)
    framework_expert: "${FRAMEWORK}-pro"
    # 解析範例: "django" → "django-pro", "nextjs" → "nextjs-expert"

    # 額外附加的 Skills (會自動添加到各階段推薦清單)
    additional_skills:
      - "${CUSTOM_SKILL_1:-}"
      - "${CUSTOM_SKILL_2:-}"
      - "${CUSTOM_SKILL_3:-}"
    # 範例: ["security-auditor", "performance-engineer", "docker-expert"]

    # 排除特定 Skills (若在某專案中不適用)
    excluded_skills:
      - "${EXCLUDED_SKILL_1:-}"
      - "${EXCLUDED_SKILL_2:-}"
    # 範例: ["frontend-developer", "mobile-developer"] (對於純後端專案)

    # 強制覆蓋特定 SDLC 狀態的 Skills (進階)
    overrides:
      implementation: "${IMPL_SKILLS:-[]}"
      # 範例: ["python-pro", "django-pro", "postgresql", "tdd-workflow"]

      testing: "${TEST_SKILLS:-[]}"
      # 範例: ["pytest", "e2e-testing-patterns", "test-automator"]

  # ========================================
  # 品質閾值配置
  # ========================================
  quality_thresholds:
    # 測試覆蓋率要求 (百分比)
    test_coverage: ${TEST_COVERAGE:-90}
    # 預設 90%，嚴格專案可設為 95+

    # 循環複雜度上限 (Cyclomatic Complexity)
    cyclomatic_complexity: ${MAX_CC:-10}
    # 預設 10，超過即觸發重構警告

    # 可維護性指數下限 (Maintainability Index)
    maintainability_index: ${MIN_MI:-65}
    # 預設 65，低於此值需要優化

    # 單一函數最大行數
    max_function_lines: ${MAX_LINES:-400}
    # 預設 400 行（根據 GEMINI.md 要求）

    # Linter 通過要求
    linter_strict: ${LINTER_STRICT:-true}
    # true: 必須零警告, false: 允許警告但需手動審核

    # 類型檢查嚴格模式
    type_check_strict: ${TYPE_CHECK_STRICT:-true}
    # Python: mypy --strict, TypeScript: strict mode

  # ========================================
  # 人工審核閘門 (HITL: Human-in-the-Loop)
  # ========================================
  human_gates:
    # Planning → Design 轉換需要批准
    planning_approval: ${REQUIRE_PLANNING_APPROVAL:-false}

    # Design → Implementation 轉換需要批准
    design_approval: ${REQUIRE_DESIGN_APPROVAL:-true}
    # 預設 true，確保設計經過審核

    # Implementation → Testing 轉換需要批准
    code_review: ${REQUIRE_CODE_REVIEW:-true}

    # Review → Deployment 轉換需要批准
    security_review: ${REQUIRE_SECURITY_REVIEW:-true}
    # 預設 true，生產環境部署前安全檢查

    # Deployment 階段需要批准
    deployment_approval: ${REQUIRE_DEPLOY_APPROVAL:-true}
    # 預設 true，防止意外部署

    # 批准超時時間 (小時)
    approval_timeout_hours: ${APPROVAL_TIMEOUT:-24}
    # 超時後工作流程自動暫停

  # ========================================
  # 檢查點與恢復
  # ========================================
  checkpoint:
    enabled: ${CHECKPOINT_ENABLED:-true}
    storage: "${CHECKPOINT_STORAGE:-sqlite}"
    # 選項: "sqlite" | "postgres" | "redis" | "file"

    interval: ${CHECKPOINT_INTERVAL:-1}
    # 每 N 個狀態轉換後儲存 (1 = 每次轉換)

    retention_days: ${CHECKPOINT_RETENTION:-30}
    # 檢查點保留天數

# ========================================
# 環境變數範例
# ========================================
# 將以下內容複製到 .env 文件或 export 到 shell：
#
# export PROJECT_NAME=""
# export PROJECT_TYPE=""
# export PRIORITY="High"
# export LANGUAGE="python"
# export FRAMEWORK="langchain,google-genai"
# export DATABASE=none
# export DEPLOYMENT="docker"
# export TEST_COVERAGE=90
# export REQUIRE_DESIGN_APPROVAL=true
# export REQUIRE_SECURITY_REVIEW=true
# export REQUIRE_DEPLOY_APPROVAL=true


